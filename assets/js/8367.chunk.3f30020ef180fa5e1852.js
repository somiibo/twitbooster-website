(self.webpackChunkultimate_jekyll=self.webpackChunkultimate_jekyll||[]).push([[6002,8367],{634:()=>{},938:()=>{},2480:()=>{},3005:()=>{},4050:()=>{},5043:()=>{},5460:(o,e,n)=>{"use strict";n.d(e,{A:()=>i});var t=n(4289),s=n.n(t);const i=async function(o,e={}){window.Manager;const t=JSON.parse(JSON.stringify(e)),{getAuth:i}=await Promise.all([n.e(9943),n.e(7480)]).then(n.bind(n,7480)),c=i().currentUser;if(!c)throw new Error("No authenticated user found");const a=await c.getIdToken();return t.headers||(t.headers={}),t.headers.Authorization="Bearer "+a,s()(o,t)}},6600:()=>{},7664:()=>{},8466:()=>{},9978:(o,e,n)=>{"use strict";n.r(e),n.d(e,{init:()=>u,loadData:()=>g,onShow:()=>f});var t=n(2984),s=n(5460);let i=null,c=null,a=null,r=new Map;const l=["google","discord","github","twitter","facebook"];function d(){return i.getApiUrl()+"/backend-manager"}async function u(o){i=o}async function g(o,e){o&&(a=o,c=e,m())}function m(){console.log("[DEBUG] displayConnections() called");const o=document.getElementById("connections-loading");if(o&&o.classList.add("d-none"),!c)return console.log("[DEBUG] No appData, showing loading state"),void(o&&o.classList.remove("d-none"));const e=c?.oauth2||{},n=a?.oauth2||{};console.log("[DEBUG] Available OAuth providers:",e),console.log("[DEBUG] User connections:",n);let i=!1;l.forEach(o=>{console.log(`[DEBUG] Processing provider: ${o}`);const l=e[o],u=document.getElementById(`connection-${o}`);if(console.log(`[DEBUG] ${o} - providerSettings:`,l),console.log(`[DEBUG] ${o} - providerSettings.enabled:`,l?.enabled),console.log(`[DEBUG] ${o} - $providerElement exists:`,!!u),!u)return void console.warn(`[DEBUG] ${o} - Provider element not found in DOM`);const g=l&&!1!==l.enabled;if(console.log(`[DEBUG] ${o} - isEnabled:`,g),g){i=!0,console.log(`[DEBUG] ${o} - Removing d-none class`),u.classList.remove("d-none"),console.log(`[DEBUG] ${o} - About to initialize FormManager`),function(o){const e=`connection-form-${o}`;if(!document.getElementById(e))return void console.warn(`Form not found for provider: ${o}`);if(r.has(o))return void console.log(`FormManager already initialized for ${o}`);console.log(`Initializing FormManager for ${o}`);const n=new t.A(`#${e}`,{submittingText:"Connecting..."});r.set(o,n),n.on("statechange",({state:e})=>{if(console.log(`[DEBUG] ${o} - FormManager state changed to:`,e),"ready"===e){console.log(`[DEBUG] ${o} - FormManager is ready, updating button status`);const e=a?.oauth2?.[o],n=c?.oauth2?.[o];h(o,e,n)}}),n.on("submit",async({data:e,$submitButton:n})=>{const t=e.provider,i=n?.getAttribute("data-action");if(console.log(`[DEBUG] ${o} - Form submitted. Action:`,i,"Provider:",t),"connect"===i)await async function(o){const e=c?.oauth2?.[o];if(!e||!1===e.enabled)throw new Error("This connection service is not available.");const n=e.scope||[],t=await(0,s.A)(d(),{method:"POST",timeout:3e4,response:"json",tries:2,body:{command:"user:oauth2",payload:{redirect:!1,provider:o,state:"authorize",scope:n,referrer:window.location.href}}});if(console.log("OAuth connect response:",t),!t.url)throw new Error(t.message||"Failed to get authorization URL");window.location.href=t.url}(t);else if("disconnect"===i){const o=await async function(o){const e=o.charAt(0).toUpperCase()+o.slice(1);if(await new Promise(o=>setTimeout(o,1)),!confirm(`Are you sure you want to disconnect your ${e} account?`))throw new Error("Disconnection cancelled");const n=(c?.oauth2?.[o]||{}).scope||[],t=await(0,s.A)(d(),{method:"POST",timeout:3e4,response:"json",tries:2,body:{command:"user:oauth2",payload:{redirect:!1,provider:o,state:"deauthorize",scope:n,referrer:window.location.href}}});if(console.log("OAuth disconnect response:",t),t.success)return a.oauth2&&a.oauth2[o]&&delete a.oauth2[o],!0;throw new Error(t.message||"Failed to disconnect")}(t);if(o){const o=c?.oauth2?.[t];h(t,null,o)}}})}(o);const e=n[o];console.log(`[DEBUG] ${o} - userConnection:`,e),console.log(`[DEBUG] ${o} - About to update provider status`),h(o,e,l)}else console.log(`[DEBUG] ${o} - Provider disabled, adding d-none class`),u.classList.add("d-none")});const u=document.getElementById("connections-empty");u&&(i?u.classList.add("d-none"):u.classList.remove("d-none"))}function h(o,e,n){console.log(`[DEBUG] updateProviderStatus() called for ${o}`),console.log(`[DEBUG] ${o} - userConnection:`,e),console.log(`[DEBUG] ${o} - userConnection truthy:`,!!e),console.log(`[DEBUG] ${o} - userConnection.identity:`,e?.identity),console.log(`[DEBUG] ${o} - providerSettings:`,n);const t=document.getElementById(`${o}-connection-status`),s=document.getElementById(`${o}-connection-description`),i=document.getElementById(`connection-form-${o}`),c=i?.querySelector('button[data-action="connect"]'),a=i?.querySelector('button[data-action="disconnect"]');console.log(`[DEBUG] ${o} - DOM elements found:`,{$status:!!t,$description:!!s,$form:!!i,$connectButton:!!c,$disconnectButton:!!a});const r=e&&e.identity;if(console.log(`[DEBUG] ${o} - isConnected:`,r),s){const e={google:"Enable single sign-on with your Google account",discord:"Connect to access Discord community features",github:"Link your GitHub account for repository access",twitter:"Share updates and connect with Twitter",facebook:"Connect your Facebook account for social features"},t=n?.description||e[o]||`Connect your ${o.charAt(0).toUpperCase()+o.slice(1)} account`;s.textContent=t,s.classList.remove("d-none")}if(t)if(r){const o=(l=e)&&l.identity?l.identity.global_name||l.identity.username||l.identity.name||l.identity.email||l.identity.id||"Connected":"Unknown";let n=`Connected: ${o}`;e.updated&&e.updated.timestamp&&(n=`${o} â€¢ ${new Date(e.updated.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`),t.textContent=n,t.classList.remove("d-none")}else t.textContent="",t.classList.add("d-none");var l;c&&a&&(console.log(`[DEBUG] ${o} - Updating buttons. isConnected:`,r),r?(c.classList.add("d-none"),a.classList.remove("d-none"),console.log(`[DEBUG] ${o} - Showing disconnect button`)):(c.classList.remove("d-none"),a.classList.add("d-none"),console.log(`[DEBUG] ${o} - Showing connect button`)))}function f(){a&&c&&m()}}}]);